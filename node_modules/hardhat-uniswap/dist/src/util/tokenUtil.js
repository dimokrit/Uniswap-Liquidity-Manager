"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getNearestUsableTick = exports.calculateSqrtPriceX96 = void 0;
const bignumber_js_1 = require("bignumber.js");
const Q192 = (0, bignumber_js_1.BigNumber)(2).exponentiatedBy(192);
function calculateSqrtPriceX96(price, token0Dec, token1Dec) {
    const _price = (0, bignumber_js_1.BigNumber)(price).shiftedBy(token1Dec - token0Dec);
    const ratioX96 = _price.multipliedBy(Q192);
    const sqrtPriceX96 = ratioX96.sqrt();
    return sqrtPriceX96;
}
exports.calculateSqrtPriceX96 = calculateSqrtPriceX96;
function getNearestUsableTick(currentTick, space) {
    // 0 is always a valid tick
    if (currentTick == 0) {
        return 0;
    }
    // Determines direction
    const direction = (currentTick >= 0) ? 1 : -1;
    // Changes direction
    currentTick *= direction;
    // Calculates nearest tick based on how close the current tick remainder is to space / 2
    let nearestTick = (currentTick % space <= space / 2) ? currentTick - (currentTick % space) : currentTick + (space - (currentTick % space));
    // Changes direction back
    nearestTick *= direction;
    return nearestTick;
}
exports.getNearestUsableTick = getNearestUsableTick;
//# sourceMappingURL=tokenUtil.js.map